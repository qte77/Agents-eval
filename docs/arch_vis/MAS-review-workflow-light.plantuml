@startuml MAS_review_workflow_light
' GitHub Light Theme (Primer)
' Sourced from: https://github.com/primer/github-vscode-theme

skinparam backgroundcolor #FFFFFF

skinparam actor {
    BackgroundColor #F6F8FA
    BorderColor #57606A
    FontColor #24292F
}
skinparam participant {
    BackgroundColor #F6F8FA
    BorderColor #57606A
    FontColor #24292F
}
skinparam database {
    BackgroundColor #F6F8FA
    BorderColor #57606A
    FontColor #24292F
}
skinparam entity {
    BackgroundColor #F6F8FA
    BorderColor #57606A
    FontColor #24292F
}
skinparam note {
    BackgroundColor #F6F8FA
    BorderColor #D0D7DE
    FontColor #24292F
}
skinparam sequence {
    ArrowColor #0969DA
    ArrowFontColor #24292F
    LifeLineBorderColor #57606A
    GroupBorderColor #D0D7DE
    GroupFontColor #24292F
    GroupHeaderFontColor #24292F
    GroupBackgroundColor #F6F8FA
}

actor User

participant "Manager Agent" as Manager
participant "Researcher Agent" as Researcher
database "PeerRead Dataset" as DB
participant "LLM" as LLM
entity "ReviewPersistence" as Persistence

User -> Manager: Request to review paper "X"
activate Manager

Manager -> DB: Get paper content for "X"
activate DB
DB --> Manager: Return paper content
deactivate DB

note right of Manager
  The Manager now loads the
  `review_template.md` and
  fills it with the paper's data.
end note

Manager -> LLM: Generate review using filled template
activate LLM
LLM --> Manager: Return structured review (ReviewGenerationResult)
deactivate LLM

Manager -> Persistence: Save review for paper "X"
activate Persistence
Persistence -> Persistence: Create timestamped JSON file
Persistence --> Manager: Confirm save
deactivate Persistence

Manager --> User: Acknowledge completion

group Optional Delegation
    Manager -> Researcher: Delegate research query
    activate Researcher
    Researcher -> Researcher: Use DuckDuckGo Search
    Researcher --> Manager: Return research results
    deactivate Researcher
end group

deactivate Manager

@enduml

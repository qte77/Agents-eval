@startuml mas-workflow
title MAS Workflow - Agent Interactions and Tool Usage

actor User

box "Agents" #LightBlue
    participant "Manager Agent" as Manager
    participant "Researcher Agent" as Researcher
    participant "Analyst Agent" as Analyst
    participant "Synthesizer Agent" as Synthesizer
end box

box "Tools" #LightGreen
    participant "DuckDuckGo Search" as DDG
    participant "PeerRead Tools" as PeerRead
    participant "Exa / Tavily" as WebSearch
end box

box "Data Storage" #LightYellow
    participant "PeerRead Dataset" as Dataset
    participant "Review Storage" as Reviews
end box

User -> Manager: Request task\n(e.g., paper review via --paper-id)
activate Manager

note right of Manager
  Manager orchestrates agents.
  PeerRead tools are on Researcher
  (Sprint 5: separation of concerns).
end note

Manager -> Researcher: delegate_research(query)
activate Researcher

Researcher -> PeerRead: get_peerread_paper(paper_id)
activate PeerRead
PeerRead -> Dataset: Load paper
activate Dataset
Dataset --> PeerRead: PeerReadPaper
deactivate Dataset
PeerRead --> Researcher: PeerReadPaper
deactivate PeerRead

Researcher -> DDG: duckduckgo_search_tool()
activate DDG
DDG --> Researcher: Search results
deactivate DDG

Researcher --> Manager: ResearchResult
deactivate Researcher

Manager -> Analyst: delegate_analysis(query)
activate Analyst
Analyst --> Manager: AnalysisResult
deactivate Analyst

Manager -> Synthesizer: delegate_synthesis(query)
activate Synthesizer
Synthesizer --> Manager: ResearchSummary
deactivate Synthesizer

Manager -> PeerRead: save_structured_review()
activate PeerRead
PeerRead -> Reviews: Save review JSON
activate Reviews
Reviews --> PeerRead: File path
deactivate Reviews
PeerRead --> Manager: File path
deactivate PeerRead

Manager --> User: Return result
deactivate Manager

@enduml
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agentic AI Papers Map</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.6.1/d3.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        
        .container {
            width: 100%;
            height: 100vh;
            position: relative;
        }
        
        .top-bar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .search-container {
            background: rgba(20, 20, 20, 0.9);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .search-input {
            background: #333;
            color: #fff;
            border: 1px solid #555;
            padding: 8px 12px;
            border-radius: 4px;
            width: 300px;
        }
        
        .panel-toggles {
            display: flex;
            gap: 8px;
        }
        
        .panel-wrapper {
            position: relative;
        }
        
        .panel-toggle {
            background: rgba(20, 20, 20, 0.9);
            color: #fff;
            border: 1px solid #333;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
        }
        
        .panel-toggle:hover {
            background: rgba(40, 40, 40, 0.9);
        }
        
        .legend {
            position: absolute;
            top: 40px;
            right: 0;
            z-index: 1000;
            background: rgba(20, 20, 20, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            max-width: 300px;
            transition: all 0.3s ease;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .legend.show {
            display: block !important;
        }
        
        .legend-header {
            margin-bottom: 10px;
        }
        
        .legend-header h3 {
            margin: 0;
            color: #fff;
            font-size: 14px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .stats-container {
            position: absolute;
            top: 40px;
            right: 0;
            z-index: 1000;
            background: rgba(20, 20, 20, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 12px;
            max-width: 200px;
            transition: all 0.3s ease;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .stats-container.show {
            display: block !important;
        }
        
        .stats-header {
            margin-bottom: 10px;
        }
        
        .stats-header h4 {
            margin: 0;
            color: #4ecdc4;
            font-size: 14px;
        }
        
        .stats-container h5 {
            margin: 10px 0 5px 0;
            color: #96ceb4;
            font-size: 12px;
        }
        
        .stats-item {
            margin: 3px 0;
            display: flex;
            justify-content: space-between;
        }
        
        .stats-topic {
            color: #ddd;
        }
        
        .stats-count {
            color: #4ecdc4;
            font-weight: bold;
        }
        
        .controls {
            position: absolute;
            top: 40px;
            right: 0;
            background: rgba(20, 20, 20, 0.95);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            white-space: nowrap;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1000;
        }
        
        .controls.show {
            display: block !important;
        }
        
        .controls-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .cluster-background {
            fill: none;
            stroke: #333;
            stroke-width: 1;
            stroke-dasharray: 5,5;
            opacity: 0.3;
        }
        
        .year-label, .topic-label {
            font-weight: bold;
            pointer-events: none;
        }
        
        .year-label {
            fill: #888;
            font-size: 16px;
        }
        
        .topic-label {
            font-size: 14px;
        }
        
        .legend-overlay {
            pointer-events: none;
        }
        
        .legend-overlay-text {
            pointer-events: none;
            font-size: 16px;
            font-weight: bold;
            text-anchor: middle;
        }
        
        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: rgba(20, 20, 20, 0.95);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }
        
        svg {
            background: #0a0a0a;
            cursor: grab;
            width: 100%;
            height: 100%;
            display: block;
        }
        
        svg:active {
            cursor: grabbing;
        }
        
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .node:hover {
            stroke-width: 3px;
        }
        
        .link {
            stroke: #666;
            stroke-opacity: 0.6;
            stroke-width: 1;
        }
        
        .link.dependency {
            stroke: #ff6b6b;
            stroke-opacity: 0.8;
        }
        
        .link.similarity {
            stroke: #4ecdc4;
            stroke-opacity: 0.6;
        }
        
        .node-label {
            font-size: 10px;
            fill: #fff;
            text-anchor: middle;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        button {
            background: #333;
            color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px;
        }
        
        button:hover {
            background: #555;
        }
        
        button.active {
            background: #4ecdc4;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search papers..." id="searchInput">
            </div>
            <div class="panel-toggles">
                <div class="panel-wrapper">
                    <button id="toggleSideLegend" class="panel-toggle">Topics +</button>
                    <div class="legend" id="sideLegend">
                        <div class="legend-header">
                            <h3>Topics</h3>
                        </div>
                        <div class="legend-content" id="sideLegendContent">
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ff6b6b"></div>
                                <span>Evaluation Frameworks</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #4ecdc4"></div>
                                <span>Multi-Agent Systems</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #45b7d1"></div>
                                <span>Safety & Security</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #96ceb4"></div>
                                <span>Self-Evolution</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #ffeaa7"></div>
                                <span>Domain-Specific</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #dda0dd"></div>
                                <span>Research Agents</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #98d8c8"></div>
                                <span>LLM-Based Agents</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: #f7dc6f"></div>
                                <span>Operational</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-wrapper">
                    <button id="toggleStats" class="panel-toggle">Stats +</button>
                    <div class="stats-container" id="statsContainer">
                        <div class="stats-header">
                            <h4>Statistics</h4>
                        </div>
                        <div class="stats-content" id="statsContent">
                            <div class="stats-item">
                                <span class="stats-topic">Total Papers:</span>
                                <span class="stats-count" id="totalPapers">0</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-topic">Relationships:</span>
                                <span class="stats-count" id="totalRelationships">0</span>
                            </div>
                            <h5>By Topic:</h5>
                            <div id="topicStats"></div>
                            <h5>By Year:</h5>
                            <div id="yearStats"></div>
                        </div>
                    </div>
                </div>
                <div class="panel-wrapper">
                    <button id="controlsToggle" class="panel-toggle">Controls +</button>
                    <div class="controls" id="controlsPanel">
                        <div class="controls-content" id="controlsContent">
                            <button id="showLabels">Toggle Labels</button>
                            <button id="showConnections" class="active">Toggle Connections</button>
                            <button id="clusterView" class="active">Cluster View</button>
                            <button id="timelineView">Timeline View</button>
                            <button id="resetZoom">Reset Zoom</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="info-panel" id="infoPanel">
            <h3 id="paperTitle"></h3>
            <p id="paperDetails"></p>
        </div>
        
        <svg id="networkSvg"></svg>
    </div>

    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            initializeVisualization();
        });
        
        function initializeVisualization() {
            try {
                // Paper data with topics, dependencies, and metadata - COMPLETE DATASET
                const papers = [
                    // 2025-08
                    {id: "2508.03858", title: "MI9 - Agent Intelligence Protocol", year: 2025, month: 8, topic: "operational", relevance: "high", approach: "runtime_governance", size: 8},
                    {id: "2508.03682", title: "Self-Questioning Language Models", year: 2025, month: 8, topic: "llm_agents", relevance: "high", approach: "self_evaluation", size: 8},
                    {id: "2508.00414", title: "Cognitive Kernel-Pro", year: 2025, month: 8, topic: "research_agents", relevance: "medium", approach: "foundation_models", size: 6},
                    
                    // 2025-07
                    {id: "2507.23276", title: "How Far Are AI Scientists", year: 2025, month: 7, topic: "research_agents", relevance: "medium", approach: "impact_assessment", size: 6},
                    {id: "2507.22414", title: "AutoCodeSherpa", year: 2025, month: 7, topic: "domain_specific", relevance: "medium", approach: "explainability", size: 6},
                    {id: "2507.21046", title: "Self-Evolving Agents Survey", year: 2025, month: 7, topic: "self_evolution", relevance: "high", approach: "evolutionary", size: 8},
                    {id: "2507.18074", title: "AlphaGo Moment for Architecture", year: 2025, month: 7, topic: "domain_specific", relevance: "low", approach: "architecture_discovery", size: 4},
                    {id: "2507.17311", title: "EarthLink Climate Agent", year: 2025, month: 7, topic: "domain_specific", relevance: "low", approach: "climate_science", size: 4},
                    {id: "2507.17257", title: "Agent Identity Evals", year: 2025, month: 7, topic: "evaluation_frameworks", relevance: "high", approach: "identity_consistency", size: 8},
                    {id: "2507.16940", title: "AURA Medical Agent", year: 2025, month: 7, topic: "domain_specific", relevance: "medium", approach: "multimodal", size: 6},
                    {id: "2507.10584", title: "ARPaCCino Compliance", year: 2025, month: 7, topic: "safety_security", relevance: "medium", approach: "compliance", size: 6},
                    {id: "2507.05178", title: "CREW-WILDFIRE", year: 2025, month: 7, topic: "multi_agent", relevance: "medium", approach: "collaboration", size: 6},
                    {id: "2507.02825", title: "Agentic Benchmarks Best Practices", year: 2025, month: 7, topic: "evaluation_frameworks", relevance: "very_high", approach: "methodology", size: 10},
                    {id: "2507.02097", title: "Multi-Agent Recommender Systems", year: 2025, month: 7, topic: "domain_specific", relevance: "low", approach: "recommendation", size: 4},
                    
                    // 2025-06
                    {id: "2506.18096", title: "Deep Research Agents", year: 2025, month: 6, topic: "research_agents", relevance: "high", approach: "systematic_methodology", size: 8},
                    {id: "2506.16499", title: "ML-Master AI-for-AI", year: 2025, month: 6, topic: "self_evolution", relevance: "medium", approach: "meta_optimization", size: 6},
                    {id: "2506.13131", title: "AlphaEvolve Coding Agent", year: 2025, month: 6, topic: "domain_specific", relevance: "medium", approach: "scientific_coding", size: 6},
                    {id: "2506.04133", title: "TRiSM Security Management", year: 2025, month: 6, topic: "safety_security", relevance: "high", approach: "trust_risk", size: 8},
                    
                    // 2025-05
                    {id: "2505.22967", title: "MermaidFlow Safety-Constrained", year: 2025, month: 5, topic: "safety_security", relevance: "high", approach: "safety_constraints", size: 8},
                    {id: "2505.22954", title: "Darwin Godel Machine", year: 2025, month: 5, topic: "self_evolution", relevance: "high", approach: "open_ended_evolution", size: 8},
                    {id: "2505.22583", title: "GitGoodBench", year: 2025, month: 5, topic: "domain_specific", relevance: "medium", approach: "git_operations", size: 6},
                    {id: "2505.19764", title: "Agentic Predictor", year: 2025, month: 5, topic: "evaluation_frameworks", relevance: "high", approach: "predictive_evaluation", size: 8},
                    {id: "2505.18946", title: "SANNet Networking", year: 2025, month: 5, topic: "multi_agent", relevance: "medium", approach: "network_coordination", size: 6},
                    {id: "2505.15872", title: "InfoDeepSeek RAG", year: 2025, month: 5, topic: "domain_specific", relevance: "medium", approach: "information_seeking", size: 6},
                    
                    // 2025-04
                    {id: "2504.19678", title: "LLM Reasoning to Autonomous Agents", year: 2025, month: 4, topic: "llm_agents", relevance: "high", approach: "comprehensive_review", size: 8},
                    {id: "2504.16902", title: "Secure Agentic AI A2A", year: 2025, month: 4, topic: "safety_security", relevance: "medium", approach: "secure_applications", size: 6},
                    
                    // 2025-03
                    {id: "2503.21460", title: "LLM Agent Survey", year: 2025, month: 3, topic: "llm_agents", relevance: "high", approach: "methodology_survey", size: 8},
                    {id: "2503.16416", title: "Evaluation of LLM-based Agents", year: 2025, month: 3, topic: "evaluation_frameworks", relevance: "very_high", approach: "systematic_evaluation", size: 10},
                    {id: "2503.14713", title: "TestForge Self-Evaluation", year: 2025, month: 3, topic: "evaluation_frameworks", relevance: "high", approach: "automated_testing", size: 8},
                    {id: "2503.13657", title: "Multi-Agent LLM Failures", year: 2025, month: 3, topic: "multi_agent", relevance: "high", approach: "failure_analysis", size: 8},
                    {id: "2503.08979", title: "Agentic AI Scientific Discovery", year: 2025, month: 3, topic: "research_agents", relevance: "medium", approach: "scientific_discovery", size: 6},
                    {id: "2503.06416", title: "AI Negotiations Competition", year: 2025, month: 3, topic: "domain_specific", relevance: "low", approach: "negotiation", size: 4},
                    {id: "2503.00237", title: "Agentic AI Systems Theory", year: 2025, month: 3, topic: "evaluation_frameworks", relevance: "high", approach: "systems_theory", size: 8},
                    
                    // 2025-02
                    {id: "2502.14776", title: "SurveyX Survey Automation", year: 2025, month: 2, topic: "domain_specific", relevance: "low", approach: "survey_automation", size: 4},
                    {id: "2502.05957", title: "AutoAgent Zero-Code", year: 2025, month: 2, topic: "operational", relevance: "medium", approach: "automation", size: 6},
                    {id: "2502.02649", title: "Autonomous Agents Should Not be Developed", year: 2025, month: 2, topic: "safety_security", relevance: "high", approach: "safety_ethics", size: 8},
                    
                    // 2025-01
                    {id: "2501.16150", title: "AI Agents for Computer Use", year: 2025, month: 1, topic: "domain_specific", relevance: "medium", approach: "computer_control", size: 6},
                    {id: "2501.06590", title: "ChemAgent", year: 2025, month: 1, topic: "domain_specific", relevance: "low", approach: "chemistry", size: 4},
                    {id: "2501.06322", title: "Multi-Agent Collaboration Survey", year: 2025, month: 1, topic: "multi_agent", relevance: "medium", approach: "collaboration_mechanisms", size: 6},
                    {id: "2501.04227", title: "Agent Laboratory Research", year: 2025, month: 1, topic: "research_agents", relevance: "medium", approach: "research_assistants", size: 6},
                    {id: "2501.00881", title: "Vertical AI Agents Guide", year: 2025, month: 1, topic: "domain_specific", relevance: "medium", approach: "industry_vertical", size: 6},
                    
                    // 2024-12
                    {id: "2412.17149", title: "Multi-AI Agent Optimization", year: 2024, month: 12, topic: "evaluation_frameworks", relevance: "high", approach: "iterative_refinement", size: 8},
                    {id: "2412.04093", title: "Practical Agentic LLM Systems", year: 2024, month: 12, topic: "operational", relevance: "high", approach: "practical_deployment", size: 8},
                    
                    // 2024-11
                    {id: "2411.13768", title: "Evaluation-driven LLM Agents", year: 2024, month: 11, topic: "evaluation_frameworks", relevance: "high", approach: "evaluation_driven", size: 8},
                    {id: "2411.13543", title: "BALROG Game Reasoning", year: 2024, month: 11, topic: "domain_specific", relevance: "medium", approach: "game_based", size: 6},
                    {id: "2411.10478", title: "LLMs for ML Workflows", year: 2024, month: 11, topic: "domain_specific", relevance: "low", approach: "ml_workflows", size: 4},
                    {id: "2411.05285", title: "AgentOps Taxonomy", year: 2024, month: 11, topic: "operational", relevance: "high", approach: "observability", size: 8},
                    
                    // 2024-10
                    {id: "2410.22457", title: "Dynamic Task Decomposition", year: 2024, month: 10, topic: "evaluation_frameworks", relevance: "very_high", approach: "novel_metrics", size: 10},
                    {id: "2410.14393", title: "Debug AI Agents", year: 2024, month: 10, topic: "domain_specific", relevance: "medium", approach: "debugging", size: 6},
                    {id: "2410.09713", title: "Agentic Information Retrieval", year: 2024, month: 10, topic: "domain_specific", relevance: "medium", approach: "information_retrieval", size: 6},
                    {id: "2408.08435", title: "Automated Agentic Design", year: 2024, month: 8, topic: "self_evolution", relevance: "medium", approach: "automated_design", size: 6},
                    {id: "2408.01768", title: "Living Software Systems", year: 2024, month: 8, topic: "self_evolution", relevance: "medium", approach: "living_systems", size: 6},
                    
                    // 2024-08
                    {id: "2408.06361", title: "Financial Trading Agent Survey", year: 2024, month: 8, topic: "domain_specific", relevance: "low", approach: "financial_trading", size: 4},
                    {id: "2408.06292", title: "AI Scientist Automated Discovery", year: 2024, month: 8, topic: "research_agents", relevance: "medium", approach: "automated_discovery", size: 6},
                    
                    // 2024-04
                    {id: "2404.13501", title: "Memory Mechanism Survey", year: 2024, month: 4, topic: "llm_agents", relevance: "high", approach: "memory_systems", size: 8},
                    
                    // 2024-02
                    {id: "2402.06360", title: "CoSearchAgent Collaborative", year: 2024, month: 2, topic: "multi_agent", relevance: "low", approach: "collaborative_search", size: 4},
                    {id: "2402.02716", title: "LLM Agent Planning Survey", year: 2024, month: 2, topic: "llm_agents", relevance: "high", approach: "planning_capabilities", size: 8},
                    {id: "2402.01030", title: "Executable Code Actions", year: 2024, month: 2, topic: "domain_specific", relevance: "medium", approach: "code_execution", size: 6},
                    
                    // 2023-08
                    {id: "2308.11432", title: "LLM Autonomous Agents Survey", year: 2023, month: 8, topic: "llm_agents", relevance: "very_high", approach: "foundational_survey", size: 10}
                ];

                // Define topic colors
                const topicColors = {
                    "evaluation_frameworks": "#ff6b6b",
                    "multi_agent": "#4ecdc4", 
                    "safety_security": "#45b7d1",
                    "self_evolution": "#96ceb4",
                    "domain_specific": "#ffeaa7",
                    "research_agents": "#dda0dd",
                    "llm_agents": "#98d8c8",
                    "operational": "#f7dc6f"
                };

                // Define dependencies and similarities - COMPLETE RELATIONSHIPS
                const relationships = [
                    // Core evaluation framework dependencies
                    {source: "2308.11432", target: "2503.16416", type: "dependency", strength: 3},
                    {source: "2503.16416", target: "2507.02825", type: "dependency", strength: 3},
                    {source: "2507.02825", target: "2410.22457", type: "dependency", strength: 2},
                    {source: "2411.13768", target: "2412.17149", type: "dependency", strength: 2},
                    
                    // Self-evaluation lineage
                    {source: "2508.03682", target: "2503.14713", type: "dependency", strength: 2},
                    {source: "2507.17257", target: "2508.03682", type: "similarity", strength: 2},
                    
                    // Multi-agent systems
                    {source: "2501.06322", target: "2507.05178", type: "dependency", strength: 2},
                    {source: "2503.13657", target: "2507.05178", type: "similarity", strength: 2},
                    {source: "2505.18946", target: "2507.05178", type: "similarity", strength: 1},
                    
                    // Safety and security
                    {source: "2502.02649", target: "2506.04133", type: "dependency", strength: 2},
                    {source: "2506.04133", target: "2505.22967", type: "dependency", strength: 2},
                    {source: "2507.10584", target: "2506.04133", type: "similarity", strength: 1},
                    
                    // Self-evolution
                    {source: "2507.21046", target: "2505.22954", type: "dependency", strength: 2},
                    {source: "2506.16499", target: "2505.22954", type: "similarity", strength: 2},
                    {source: "2408.08435", target: "2507.21046", type: "similarity", strength: 1},
                    
                    // Research agents
                    {source: "2507.23276", target: "2506.18096", type: "dependency", strength: 2},
                    {source: "2408.06292", target: "2507.23276", type: "similarity", strength: 2},
                    {source: "2501.04227", target: "2506.18096", type: "similarity", strength: 1},
                    
                    // LLM-based agents progression
                    {source: "2308.11432", target: "2404.13501", type: "dependency", strength: 2},
                    {source: "2404.13501", target: "2402.02716", type: "dependency", strength: 2},
                    {source: "2503.21460", target: "2504.19678", type: "dependency", strength: 2},
                    
                    // Operational systems
                    {source: "2411.05285", target: "2508.03858", type: "dependency", strength: 2},
                    {source: "2412.04093", target: "2411.05285", type: "similarity", strength: 2},
                    {source: "2502.05957", target: "2411.05285", type: "similarity", strength: 1},
                    
                    // Cross-topic similarities
                    {source: "2505.19764", target: "2410.22457", type: "similarity", strength: 2},
                    {source: "2503.00237", target: "2507.02825", type: "similarity", strength: 2},
                    {source: "2507.16940", target: "2501.16150", type: "similarity", strength: 1},
                ];

                // Use fixed dimensions for reliability
                const width = 1200;
                const height = 800;
                
                const svg = d3.select("#networkSvg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("viewBox", `0 0 ${width} ${height}`);

                // Add zoom behavior with error handling
                const zoom = d3.zoom()
                    .scaleExtent([0.1, 4])
                    .on("zoom", function(event) {
                        try {
                            g.attr("transform", event.transform);
                        } catch (e) {
                            console.warn("Zoom error:", e);
                        }
                    });

                svg.call(zoom);

                const g = svg.append("g");

                // Create simulation with simplified forces
                const simulation = d3.forceSimulation(papers)
                    .force("link", d3.forceLink(relationships).id(d => d.id).distance(100))
                    .force("charge", d3.forceManyBody().strength(-300))
                    .force("center", d3.forceCenter(width / 2, height / 2))
                    .force("collision", d3.forceCollide().radius(d => d.size + 5));

                // Topic centers for clustering
                const topicCenters = {
                    "evaluation_frameworks": {x: width * 0.3, y: height * 0.3},
                    "multi_agent": {x: width * 0.7, y: height * 0.3},
                    "safety_security": {x: width * 0.3, y: height * 0.7},
                    "self_evolution": {x: width * 0.7, y: height * 0.7},
                    "domain_specific": {x: width * 0.8, y: height * 0.5},
                    "research_agents": {x: width * 0.5, y: height * 0.2},
                    "llm_agents": {x: width * 0.2, y: height * 0.5},
                    "operational": {x: width * 0.5, y: height * 0.8}
                };

                let clusterView = true;

                function updateForces() {
                    try {
                        if (clusterView) {
                            simulation.force("cluster", d3.forceX(d => topicCenters[d.topic].x).strength(0.3))
                                     .force("clusterY", d3.forceY(d => topicCenters[d.topic].y).strength(0.3));
                        } else {
                            simulation.force("cluster", d3.forceX(d => (d.year - 2023) * 200 + 100).strength(0.5))
                                     .force("clusterY", d3.forceY(height / 2).strength(0.1));
                        }
                        simulation.alpha(0.3).restart();
                    } catch (e) {
                        console.warn("Force update error:", e);
                    }
                }

                // Create links
                const link = g.append("g")
                    .selectAll("line")
                    .data(relationships)
                    .join("line")
                    .attr("class", d => `link ${d.type}`)
                    .attr("stroke-width", d => d.strength);

                // Create nodes
                const node = g.append("g")
                    .selectAll("circle")
                    .data(papers)
                    .join("circle")
                    .attr("class", "node")
                    .attr("r", d => d.size)
                    .attr("fill", d => topicColors[d.topic])
                    .attr("stroke", "#fff")
                    .attr("stroke-width", 1)
                    .on("click", function(event, d) {
                        try {
                            showPaperInfo(event, d);
                        } catch (e) {
                            console.warn("Click error:", e);
                        }
                    })
                    .on("mouseover", function(event, d) {
                        try {
                            highlightConnections(event, d);
                        } catch (e) {
                            console.warn("Mouseover error:", e);
                        }
                    })
                    .on("mouseout", function(event, d) {
                        try {
                            unhighlightConnections();
                        } catch (e) {
                            console.warn("Mouseout error:", e);
                        }
                    })
                    .call(d3.drag()
                        .on("start", dragstarted)
                        .on("drag", dragged)
                        .on("end", dragended));

                // Create labels
                const label = g.append("g")
                    .selectAll("text")
                    .data(papers)
                    .join("text")
                    .attr("class", "node-label")
                    .attr("dy", ".35em")
                    .text(d => d.title.length > 20 ? d.title.substring(0, 20) + "..." : d.title);

                // Simulation tick
                simulation.on("tick", function() {
                    try {
                        link
                            .attr("x1", d => d.source.x)
                            .attr("y1", d => d.source.y)
                            .attr("x2", d => d.target.x)
                            .attr("y2", d => d.target.y);

                        node
                            .attr("cx", d => d.x)
                            .attr("cy", d => d.y);

                        label
                            .attr("x", d => d.x)
                            .attr("y", d => d.y + d.size + 15);
                    } catch (e) {
                        console.warn("Tick error:", e);
                    }
                });

                // Add tick events for dynamic updates
                simulation.on("tick.cluster", drawClusterBoundaries);
                simulation.on("tick.labels", updateLabels);

                // Event handlers with error handling
                function dragstarted(event, d) {
                    try {
                        if (!event.active) simulation.alphaTarget(0.3).restart();
                        d.fx = d.x;
                        d.fy = d.y;
                    } catch (e) {
                        console.warn("Drag start error:", e);
                    }
                }

                function dragged(event, d) {
                    try {
                        d.fx = event.x;
                        d.fy = event.y;
                    } catch (e) {
                        console.warn("Drag error:", e);
                    }
                }

                function dragended(event, d) {
                    try {
                        if (!event.active) simulation.alphaTarget(0);
                        d.fx = null;
                        d.fy = null;
                    } catch (e) {
                        console.warn("Drag end error:", e);
                    }
                }

                function showPaperInfo(event, d) {
                    try {
                        const panel = document.getElementById("infoPanel");
                        const title = document.getElementById("paperTitle");
                        const details = document.getElementById("paperDetails");
                        
                        title.textContent = `[${d.id}] ${d.title}`;
                        details.innerHTML = `
                            <strong>Year:</strong> ${d.year}<br>
                            <strong>Topic:</strong> ${d.topic.replace('_', ' ')}<br>
                            <strong>Approach:</strong> ${d.approach.replace('_', ' ')}<br>
                            <strong>Relevance for Agents-eval:</strong> ${d.relevance}<br>
                            <strong>Connections:</strong> ${getConnectionInfo(d)}
                        `;
                        
                        panel.style.display = "block";
                    } catch (e) {
                        console.warn("Show info error:", e);
                    }
                }

                function getConnectionInfo(d) {
                    const incoming = relationships.filter(r => r.target === d.id || (r.target.id && r.target.id === d.id));
                    const outgoing = relationships.filter(r => r.source === d.id || (r.source.id && r.source.id === d.id));
                    
                    let info = "";
                    if (incoming.length > 0) {
                        const sources = incoming.map(r => r.source.id || r.source).join(", ");
                        info += `Built upon: ${sources}. `;
                    }
                    if (outgoing.length > 0) {
                        const targets = outgoing.map(r => r.target.id || r.target).join(", ");
                        info += `Influences: ${targets}.`;
                    }
                    return info || "No direct connections mapped.";
                }

                function highlightConnections(event, d) {
                    try {
                        const connectedIds = new Set();
                        connectedIds.add(d.id);
                        
                        relationships.forEach(rel => {
                            if (rel.source.id === d.id || rel.source === d.id) {
                                connectedIds.add(rel.target.id || rel.target);
                            }
                            if (rel.target.id === d.id || rel.target === d.id) {
                                connectedIds.add(rel.source.id || rel.source);
                            }
                        });

                        node.style("opacity", n => connectedIds.has(n.id) ? 1 : 0.3);
                        link.style("opacity", l => {
                            const sourceId = l.source.id || l.source;
                            const targetId = l.target.id || l.target;
                            return sourceId === d.id || targetId === d.id ? 1 : 0.1;
                        });
                        label.style("opacity", n => connectedIds.has(n.id) ? 1 : 0);
                    } catch (e) {
                        console.warn("Highlight error:", e);
                    }
                }

                function unhighlightConnections() {
                    try {
                        node.style("opacity", 1);
                        link.style("opacity", d => d.type === "dependency" ? 0.8 : 0.6);
                        const showLabels = document.getElementById("showLabels").classList.contains("active");
                        label.style("opacity", showLabels ? 1 : 0);
                    } catch (e) {
                        console.warn("Unhighlight error:", e);
                    }
                }

                // Add cluster boundaries and labels
                function drawClusterBoundaries() {
                    if (!clusterView) {
                        g.selectAll(".cluster-background").remove();
                        return;
                    }
                    
                    try {
                        g.selectAll(".cluster-background").remove();
                        
                        Object.entries(topicCenters).forEach(([topic, center]) => {
                            const topicPapers = papers.filter(p => p.topic === topic);
                            if (topicPapers.length === 0) return;
                            
                            const hull = d3.polygonHull(topicPapers.map(p => [p.x || center.x, p.y || center.y]));
                            if (hull) {
                                g.append("path")
                                    .datum(hull)
                                    .attr("class", "cluster-background")
                                    .attr("d", d3.line().curve(d3.curveCatmullRomClosed)(hull))
                                    .attr("stroke", topicColors[topic]);
                            }
                        });
                    } catch (e) {
                        console.warn("Cluster boundaries error:", e);
                    }
                }

                function drawYearLabels() {
                    if (clusterView) {
                        g.selectAll(".year-label").remove();
                        return;
                    }
                    
                    try {
                        const years = [...new Set(papers.map(p => p.year))].sort();
                        
                        g.selectAll(".year-label")
                            .data(years)
                            .join("text")
                            .attr("class", "year-label")
                            .attr("x", (d, i) => (d - 2023) * 200 + 100)
                            .attr("y", 50)
                            .attr("text-anchor", "middle")
                            .text(d => d);
                    } catch (e) {
                        console.warn("Year labels error:", e);
                    }
                }

                function drawTopicLabels() {
                    if (!clusterView) {
                        g.selectAll(".topic-label").remove();
                        g.selectAll(".legend-overlay").remove();
                        return;
                    }
                    
                    try {
                        // Remove existing labels and legend overlays
                        g.selectAll(".topic-label").remove();
                        g.selectAll(".legend-overlay").remove();
                        
                        // Add legend overlay items positioned outside each cluster
                        const legendData = [
                            {topic: "evaluation_frameworks", name: "Evaluation Frameworks", position: "top-left"},
                            {topic: "multi_agent", name: "Multi-Agent Systems", position: "top-right"},
                            {topic: "safety_security", name: "Safety & Security", position: "bottom-left"},
                            {topic: "self_evolution", name: "Self-Evolution", position: "bottom-right"},
                            {topic: "domain_specific", name: "Domain-Specific", position: "right"},
                            {topic: "research_agents", name: "Research Agents", position: "top"},
                            {topic: "llm_agents", name: "LLM-Based Agents", position: "left"},
                            {topic: "operational", name: "Operational", position: "bottom"}
                        ];
                        
                        const legendOverlay = g.append("g").attr("class", "legend-overlay");
                        
                        legendData.forEach((item) => {
                            const center = topicCenters[item.topic];
                            if (!center) return;
                            
                            // Calculate position outside the cluster based on position hint
                            let x = center.x;
                            let y = center.y;
                            
                            switch(item.position) {
                                case "top":
                                    y = center.y - 120;
                                    break;
                                case "bottom":
                                    y = center.y + 120;
                                    break;
                                case "left":
                                    x = center.x - 140;
                                    break;
                                case "right":
                                    x = center.x + 140;
                                    break;
                                case "top-left":
                                    x = center.x - 100;
                                    y = center.y - 100;
                                    break;
                                case "top-right":
                                    x = center.x + 100;
                                    y = center.y - 100;
                                    break;
                                case "bottom-left":
                                    x = center.x - 100;
                                    y = center.y + 100;
                                    break;
                                case "bottom-right":
                                    x = center.x + 100;
                                    y = center.y + 100;
                                    break;
                            }
                            
                            // Add text label with appropriate color
                            legendOverlay.append("text")
                                .attr("class", "legend-overlay-text")
                                .attr("x", x)
                                .attr("y", y)
                                .attr("fill", topicColors[item.topic])
                                .text(item.name);
                        });
                        
                    } catch (e) {
                        console.warn("Topic labels error:", e);
                    }
                }

                function updateLabels() {
                    if (clusterView) {
                        drawTopicLabels();
                        g.selectAll(".year-label").remove();
                    } else {
                        drawYearLabels();
                        g.selectAll(".topic-label").remove();
                        g.selectAll(".legend-overlay").remove();
                    }
                }

                function updateStatistics() {
                    try {
                        // Update total counts
                        document.getElementById("totalPapers").textContent = papers.length;
                        document.getElementById("totalRelationships").textContent = relationships.length;
                        
                        // Calculate topic statistics
                        const topicCounts = {};
                        papers.forEach(p => {
                            topicCounts[p.topic] = (topicCounts[p.topic] || 0) + 1;
                        });
                        
                        // Update topic stats display
                        const topicStatsContainer = document.getElementById("topicStats");
                        topicStatsContainer.innerHTML = "";
                        
                        Object.entries(topicCounts)
                            .sort(([,a], [,b]) => b - a) // Sort by count descending
                            .forEach(([topic, count]) => {
                                const div = document.createElement("div");
                                div.className = "stats-item";
                                div.innerHTML = `
                                    <span class="stats-topic">${topic.replace('_', ' ')}:</span>
                                    <span class="stats-count">${count}</span>
                                `;
                                topicStatsContainer.appendChild(div);
                            });
                        
                        // Calculate year statistics
                        const yearCounts = {};
                        papers.forEach(p => {
                            yearCounts[p.year] = (yearCounts[p.year] || 0) + 1;
                        });
                        
                        // Update year stats display
                        const yearStatsContainer = document.getElementById("yearStats");
                        yearStatsContainer.innerHTML = "";
                        
                        Object.entries(yearCounts)
                            .sort(([a,], [b,]) => b - a) // Sort by year descending
                            .forEach(([year, count]) => {
                                const div = document.createElement("div");
                                div.className = "stats-item";
                                div.innerHTML = `
                                    <span class="stats-topic">${year}:</span>
                                    <span class="stats-count">${count}</span>
                                `;
                                yearStatsContainer.appendChild(div);
                            });
                            
                    } catch (e) {
                        console.warn("Statistics update error:", e);
                    }
                }

                // Initialize controls
                function initializeControls() {
                    // Controls toggle functionality
                    let controlsOpen = false;
                    
                    document.getElementById("controlsToggle").addEventListener("click", function(event) {
                        event.stopPropagation();
                        const controls = document.getElementById("controlsPanel");
                        const isVisible = controls.classList.contains("show");
                        
                        if (!isVisible) {
                            controls.classList.add("show");
                            this.textContent = "Controls âˆ’";
                            controlsOpen = true;
                        } else {
                            controls.classList.remove("show");
                            this.textContent = "Controls +";
                            controlsOpen = false;
                        }
                    });

                    // Legend toggle functionality
                    document.getElementById("toggleSideLegend").addEventListener("click", function(event) {
                        event.stopPropagation();
                        const legend = document.getElementById("sideLegend");
                        const isVisible = legend.classList.contains("show");
                        
                        if (!isVisible) {
                            legend.classList.add("show");
                            this.textContent = "Topics âˆ’";
                        } else {
                            legend.classList.remove("show");
                            this.textContent = "Topics +";
                        }
                    });

                    // Statistics toggle functionality
                    document.getElementById("toggleStats").addEventListener("click", function(event) {
                        event.stopPropagation();
                        const stats = document.getElementById("statsContainer");
                        const isVisible = stats.classList.contains("show");
                        
                        if (!isVisible) {
                            stats.classList.add("show");
                            this.textContent = "Stats âˆ’";
                        } else {
                            stats.classList.remove("show");
                            this.textContent = "Stats +";
                        }
                    });

                    // Close panels when clicking outside
                    document.addEventListener("click", function(event) {
                        const topicsWrapper = document.querySelector(".panel-wrapper:first-child");
                        const topicsPanel = document.getElementById("sideLegend");
                        if (topicsPanel.classList.contains("show") && !topicsWrapper.contains(event.target)) {
                            topicsPanel.classList.remove("show");
                            document.getElementById("toggleSideLegend").textContent = "Topics +";
                        }
                        
                        const statsWrapper = document.querySelector(".panel-wrapper:nth-child(2)");
                        const statsPanel = document.getElementById("statsContainer");
                        if (statsPanel.classList.contains("show") && !statsWrapper.contains(event.target)) {
                            statsPanel.classList.remove("show");
                            document.getElementById("toggleStats").textContent = "Stats +";
                        }
                        
                        if (controlsOpen) {
                            const controlsWrapper = document.querySelector(".panel-wrapper:last-child");
                            if (!controlsWrapper.contains(event.target)) {
                                const controls = document.getElementById("controlsPanel");
                                const toggleBtn = document.getElementById("controlsToggle");
                                
                                controls.classList.remove("show");
                                toggleBtn.textContent = "Controls +";
                                controlsOpen = false;
                            }
                        }
                    });

                    document.addEventListener("keydown", function(event) {
                        if (event.key === "Escape") {
                            // Close all panels on escape
                            const controls = document.getElementById("controlsPanel");
                            const toggleBtn = document.getElementById("controlsToggle");
                            const topics = document.getElementById("sideLegend");
                            const topicsBtn = document.getElementById("toggleSideLegend");
                            const stats = document.getElementById("statsContainer");
                            const statsBtn = document.getElementById("toggleStats");
                            
                            if (controlsOpen) {
                                controls.classList.remove("show");
                                toggleBtn.textContent = "Controls +";
                                controlsOpen = false;
                            }
                            
                            if (topics.classList.contains("show")) {
                                topics.classList.remove("show");
                                topicsBtn.textContent = "Topics +";
                            }
                            
                            if (stats.classList.contains("show")) {
                                stats.classList.remove("show");
                                statsBtn.textContent = "Stats +";
                            }
                        }
                    });

                    // Prevent clicks inside panels from closing them
                    document.getElementById("controlsPanel").addEventListener("click", function(event) {
                        event.stopPropagation();
                    });
                    document.getElementById("sideLegend").addEventListener("click", function(event) {
                        event.stopPropagation();
                    });
                    document.getElementById("statsContainer").addEventListener("click", function(event) {
                        event.stopPropagation();
                    });

                    // Control buttons
                    document.getElementById("showLabels").addEventListener("click", function() {
                        this.classList.toggle("active");
                        const show = this.classList.contains("active");
                        label.style("opacity", show ? 1 : 0);
                    });

                    document.getElementById("showConnections").addEventListener("click", function() {
                        this.classList.toggle("active");
                        const show = this.classList.contains("active");
                        link.style("opacity", show ? (d => d.type === "dependency" ? 0.8 : 0.6) : 0);
                    });

                    document.getElementById("clusterView").addEventListener("click", function() {
                        document.getElementById("timelineView").classList.remove("active");
                        this.classList.add("active");
                        clusterView = true;
                        updateForces();
                    });

                    document.getElementById("timelineView").addEventListener("click", function() {
                        document.getElementById("clusterView").classList.remove("active");
                        this.classList.add("active");
                        clusterView = false;
                        updateForces();
                    });

                    document.getElementById("resetZoom").addEventListener("click", function() {
                        svg.transition().duration(750).call(
                            zoom.transform,
                            d3.zoomIdentity
                        );
                    });

                    // Search functionality
                    document.getElementById("searchInput").addEventListener("input", function() {
                        const query = this.value.toLowerCase();
                        
                        node.style("opacity", d => {
                            const match = d.title.toLowerCase().includes(query) || 
                                         d.id.includes(query) || 
                                         d.topic.includes(query);
                            return query === "" ? 1 : (match ? 1 : 0.2);
                        });
                    });

                    // Close info panel when clicking SVG
                    svg.on("click", function(event) {
                        if (event.target.tagName === "svg") {
                            document.getElementById("infoPanel").style.display = "none";
                        }
                    });
                }

                // Initialize everything
                updateForces();
                updateStatistics();
                initializeControls();

                console.log("Visualization initialized successfully!");
                
            } catch (error) {
                console.error("Visualization initialization failed:", error);
                
                // Fallback: show a simple error message
                document.querySelector('.container').innerHTML = `
                    <div style="color: white; padding: 20px; text-align: center;">
                        <h2>Visualization Error</h2>
                        <p>Failed to load the interactive map. Error: ${error.message}</p>
                        <p>Please check the browser console for more details.</p>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>